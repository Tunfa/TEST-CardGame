# 技能組件完整文檔

本文檔詳細說明遊戲中所有技能效果類型及其參數配置。

## 目錄

- [隊長技能效果 (Leader Skills)](#隊長技能效果-leader-skills)
- [敵人技能效果 (Enemy Skills)](#敵人技能效果-enemy-skills)
- [主動技能效果 (Active Skills)](#主動技能效果-active-skills)
- [參數類型說明](#參數類型說明)
- [元素類型對照表](#元素類型對照表)

---

## 隊長技能效果 (Leader Skills)

隊長技能效果ID以 `LS_` 開頭，配置於 `data/config/leader_skills.json`

### 永久屬性倍率效果 (觸發時機: PERMANENT)

#### HP_MULTIPLIER
**效果**: 提升指定屬性的生命力倍率
**中文描述**: "X屬性生命力 X 倍"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素 ("FIRE", "WATER", "WOOD", "METAL", "EARTH", "HEART", "ALL")
- `multiplier` (float): 生命力倍率 (例如 1.5)

**配置範例**:
```json
{
  "effect_type": "HP_MULTIPLIER",
  "target_element": "FIRE",
  "multiplier": 1.5
}
```

---

#### RECOVERY_MULTIPLIER
**效果**: 提升指定屬性的回復力倍率
**中文描述**: "X屬性回復力 X 倍"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `multiplier` (float): 回復力倍率

**配置範例**:
```json
{
  "effect_type": "RECOVERY_MULTIPLIER",
  "target_element": "WATER",
  "multiplier": 2.0
}
```

---

#### TEAM_ELEMENT_MULTIPLIER
**效果**: 根據隊伍中指定屬性成員數量提升攻擊倍率
**中文描述**: "隊伍中越多X屬性成員，X屬性傷害越高"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `base_multiplier` (float): 基礎倍率 (例如 1.0)
- `max_multiplier` (float): 最高倍率 (例如 2.5)
- `per_member_boost` (float): 每位成員增加倍率 (例如 0.3)

**配置範例**:
```json
{
  "effect_type": "TEAM_ELEMENT_MULTIPLIER",
  "target_element": "FIRE",
  "base_multiplier": 1.0,
  "max_multiplier": 2.5,
  "per_member_boost": 0.3
}
```

---

#### TEAM_DIVERSITY_MULTIPLIER
**效果**: 根據隊伍屬性多樣性提升全隊攻擊倍率
**中文描述**: "隊伍屬性越多元，攻擊倍率越高"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `base_multiplier` (float): 基礎倍率
- `max_multiplier` (float): 最高倍率
- `per_unique_boost` (float): 每種屬性增加倍率 (例如 0.2)

**配置範例**:
```json
{
  "effect_type": "TEAM_DIVERSITY_MULTIPLIER",
  "base_multiplier": 1.0,
  "max_multiplier": 2.0,
  "per_unique_boost": 0.2
}
```

---

#### EXTEND_SLASH_TIME
**效果**: 延長斬擊時間
**中文描述**: "延長斬擊時間 X 秒"
**技能類別**: 都支持（隊長技能系列、主動技能系列）
**適用對象**: 友軍技能
**參數**:
- `extend_seconds` (float): 延長秒數 (例如 2.0)

**配置範例**:
```json
{
  "effect_type": "EXTEND_SLASH_TIME",
  "extend_seconds": 2.0
}
```

---

#### IGNORE_RESISTANCE
**效果**: 無視指定屬性的克制關係
**中文描述**: "X屬性無視屬性克制"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素

**配置範例**:
```json
{
  "effect_type": "IGNORE_RESISTANCE",
  "target_element": "FIRE"
}
```

---

#### ORB_DUAL_EFFECT
**效果**: 指定靈珠兼具另一屬性效果
**中文描述**: "X屬性靈珠兼具Y屬性 Z% 效果"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `source_element` (string): 來源元素
- `target_element` (string): 目標元素
- `effect_percent` (float): 效果百分比 (例如 50.0)

**配置範例**:
```json
{
  "effect_type": "ORB_DUAL_EFFECT",
  "source_element": "HEART",
  "target_element": "FIRE",
  "effect_percent": 50.0
}
```

---

#### ORB_CAPACITY_BOOST
**效果**: 提升指定屬性靈珠容量上限
**中文描述**: "X屬性靈珠容量 +Y"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `bonus_capacity` (int): 額外容量 (例如 5)

**配置範例**:
```json
{
  "effect_type": "ORB_CAPACITY_BOOST",
  "target_element": "WATER",
  "bonus_capacity": 5
}
```

---

### 傷害倍率效果 (觸發時機: BEFORE_ATTACK)

#### DAMAGE_MULTIPLIER
**效果**: 提升指定屬性的傷害倍率
**中文描述**: "X屬性傷害 X 倍"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `multiplier` (float): 傷害倍率

**配置範例**:
```json
{
  "effect_type": "DAMAGE_MULTIPLIER",
  "target_element": "FIRE",
  "multiplier": 2.0
}
```

---

#### BASE_DAMAGE_BOOST
**效果**: 提升指定屬性的基礎傷害百分比（直接作用於卡牌攻擊力）
**中文描述**: "X屬性基礎傷害 +Y%"
**觸發時機**: PERMANENT（戰鬥開始時立即套用到卡牌屬性）
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `boost_percent` (float): 提升百分比 (例如 30.0)

**配置範例**:
```json
{
  "effect_type": "BASE_DAMAGE_BOOST",
  "target_element": "FIRE",
  "boost_percent": 30.0
}
```

**說明**:
- 此效果會在戰鬥開始時直接應用到符合元素的卡牌攻擊力
- 效果會立即反映在戰鬥UI的卡牌數值上
- 倍率計算：新攻擊力 = 原攻擊力 × (1 + boost_percent / 100)

---

#### ALL_DAMAGE_BOOST
**效果**: 提升指定屬性的所有傷害類型
**中文描述**: "X屬性全能傷害 +Y%"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `boost_percent` (float): 提升百分比

**配置範例**:
```json
{
  "effect_type": "ALL_DAMAGE_BOOST",
  "target_element": "WATER",
  "boost_percent": 50.0
}
```

---

#### ORB_COUNT_MULTIPLIER
**效果**: 根據儲存靈珠數量提升傷害倍率
**中文描述**: "X屬性靈珠越多傷害越高"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `base_multiplier` (float): 基礎倍率 (例如 1.0)
- `max_multiplier` (float): 最高倍率 (例如 3.0)
- `orb_per_tier` (int): 每級所需靈珠數 (例如 3)

**配置範例**:
```json
{
  "effect_type": "ORB_COUNT_MULTIPLIER",
  "target_element": "FIRE",
  "base_multiplier": 1.0,
  "max_multiplier": 3.0,
  "orb_per_tier": 3
}
```

---

### 靈珠規則效果 (觸發時機: TURN_START)

#### FORCE_ORB_SPAWN
**效果**: 固定生成指定數量的元素靈珠
**中文描述**: "前X粒固定出現Y屬性靈珠"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `count` (int): 靈珠數量

**配置範例**:
```json
{
  "effect_type": "FORCE_ORB_SPAWN",
  "target_element": "FIRE",
  "count": 5
}
```

---

#### ORB_SPAWN_RATE_BOOST
**效果**: 提升指定元素靈珠出現機率
**中文描述**: "X屬性靈珠出現率 +Y%"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `target_element` (string): 目標元素
- `boost_percent` (float): 提升百分比

**配置範例**:
```json
{
  "effect_type": "ORB_SPAWN_RATE_BOOST",
  "target_element": "WOOD",
  "boost_percent": 15.0
}
```

---

#### ORB_DROP_END_TURN
**效果**: 回合結束時掉落靈珠
**中文描述**: "回合結束掉落X屬性靈珠 Y 顆"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `element` (string): 元素類型
- `count` (int): 掉落數量
- `drop_timing` (string): 掉落時機 ("end_turn" 或 "immediate")

**配置範例**:
```json
{
  "effect_type": "ORB_DROP_END_TURN",
  "element": "HEART",
  "count": 3,
  "drop_timing": "end_turn"
}
```

---

#### ORB_DROP_ON_SLASH
**效果**: 斬擊指定屬性時掉落靈珠（支持機率和不同屬性掉落）
**中文描述**: "斬擊X屬性時有Y%機率掉落Z顆A屬性靈珠"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `slash_element` (string): 斬擊的元素類型
- `drop_element` (string): 掉落的元素類型（可選，默認與 slash_element 相同）
- `count` (int): 掉落數量
- `chance_percent` (float): 掉落機率百分比（可選，默認100.0，即必定掉落）

**配置範例**:
```json
{
  "effect_type": "ORB_DROP_ON_SLASH",
  "slash_element": "FIRE",
  "drop_element": "HEART",
  "count": 2,
  "chance_percent": 25.0
}
```

**說明**:
- `slash_element`: 當斬擊這個屬性的珠時觸發
- `drop_element`: 掉落的靈珠屬性（如果省略，則掉落與 slash_element 相同的屬性）
- `chance_percent`: 如果不指定，默認為 100%（必定掉落）
- 每次斬擊對應元素珠時都會進行一次機率判定
- 例子：斬擊火珠時有25%機率掉落2顆心珠

**向後兼容**:
舊格式（使用 `element` 參數）仍然支持：
```json
{
  "effect_type": "ORB_DROP_ON_SLASH",
  "element": "FIRE",
  "count": 2
}
```

---

#### SLASH_ORB_SPAWN
**效果**: 斬擊累積後生成靈珠（支持不同屬性生成）
**中文描述**: "斬擊X屬性累積Y粒後立刻生成Z顆A屬性靈珠"
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `slash_element` (string): 斬擊的元素類型
- `spawn_element` (string): 生成的元素類型（可選，默認與 slash_element 相同）
- `required_count` (int): 累積所需數量（默認3）
- `spawn_count` (int): 生成數量（默認1）

**配置範例**:
```json
{
  "effect_type": "SLASH_ORB_SPAWN",
  "slash_element": "FIRE",
  "spawn_element": "HEART",
  "required_count": 3,
  "spawn_count": 2
}
```

**說明**:
- `slash_element`: 累積這個屬性的斬擊次數
- `spawn_element`: 達到累積要求後生成的靈珠屬性（如果省略，則生成與 slash_element 相同的屬性）
- `required_count`: 需要累積斬擊的次數
- `spawn_count`: 達到要求後生成的靈珠數量
- 累積計數器會在達到要求後重置
- 生成的靈珠會優先出現（添加到序列前面）
- 例子：斬擊火珠累積3次後，下2顆必出心珠

**向後兼容**:
舊格式（使用 `element` 和 `count` 參數）仍然支持：
```json
{
  "effect_type": "SLASH_ORB_SPAWN",
  "element": "WATER",
  "count": 3
}
```

---

### 回合結束效果 (觸發時機: PERMANENT，於斬擊結束時執行)

#### END_TURN_DAMAGE
**效果**: 斬擊結束對敵人造成固定傷害（需檢查敵人技能條件）
**中文描述**: "斬擊結束造成X屬性傷害 Y 點"
**觸發時機**: PERMANENT（戰鬥開始註冊，在斬擊結束時執行）
**技能類別**: 隊長技能系列
**適用對象**: 友軍技能
**參數**:
- `element` (string): 傷害元素
- `damage` (int): 傷害數值

**配置範例**:
```json
{
  "effect_type": "END_TURN_DAMAGE",
  "element": "FIRE",
  "damage": 3
}
```

**執行邏輯**:
1. 玩家斬擊星盤
2. 斬擊時間到
3. 對全體存活敵人執行以下檢查：
   - 檢查敵人是否有技能條件（如 REQUIRE_COMBO "需要5連擊才能造成傷害"）
   - 如果有條件且滿足 → 造成傷害
   - 如果有條件但不滿足 → 造成0點傷害
   - 如果沒有技能條件 → 造成傷害

**說明**:
- 此傷害會受敵人技能條件影響（例如：REQUIRE_COMBO、REQUIRE_ORB_TOTAL 等）
- 傷害判定會使用當前的連擊數、消除的靈珠數等狀態
- 每次斬擊結束都會觸發
- 可以用來擊殺有技能條件保護的敵人（只要滿足條件）

**範例場景**:
```
隊長技能：斬擊結束造成3點火傷害
敵人技能：需要5連擊才能造成傷害

玩家斬擊 3 連擊 → END_TURN_DAMAGE 造成 0 點傷害（不滿足5連擊）
玩家斬擊 5 連擊 → END_TURN_DAMAGE 造成 3 點傷害（滿足5連擊）
```

---

## 敵人技能效果 (Enemy Skills)

敵人技能效果ID以 `ES_` 開頭，配置於 `data/config/enemy_skills.json`

### ⚠️ 重要：敵人技能疊加規則

敵人技能分為兩大類，疊加規則不同：

#### 1. 條件類技能（所有都生效）
當多個敵人擁有相同的條件類技能時，**所有條件都需要滿足**。

**條件類技能包括**:
- REQUIRE_COMBO（需要X連擊）
- REQUIRE_ORB_TOTAL（需要X粒靈珠）
- REQUIRE_ORB_CONTINUOUS（需要連續X粒靈珠）
- REQUIRE_ELEMENTS（需要X種元素）

**範例**: 如果場上有2個敵人都擁有「需要5連擊」技能，玩家需要達到5連擊才能對兩個敵人都造成傷害（不是10連擊）。

#### 2. 負面效果技能（相同ID只生效一次）
當多個敵人擁有相同的負面效果技能時，**相同 skill_id 只會觸發一次**。

**負面效果技能包括**:
- DAMAGE_REDUCTION_PERCENT（減傷百分比）
- DAMAGE_REDUCTION_FLAT（減傷固定值）
- SEAL_ACTIVE_SKILL（封印主動技能）
- DISABLE_ELEMENT_SLASH（禁用元素斬擊）
- ZERO_RECOVERY（回復力歸零）
- REDUCE_SLASH_TIME（減少斬擊時間）
- ENTER_HP_TO_ONE（進場HP扣至1）
- DEATH_DAMAGE（死亡傷害）
- REVIVE_ONCE（復活一次）

**範例**: 如果場上有2個敵人都擁有「減少斬擊時間2秒」技能（相同 skill_id），只會減少2秒，而不是4秒。

---

### 條件類效果（阻擋傷害）

#### REQUIRE_COMBO
**效果**: 需要達到指定連擊數才能造成傷害
**中文描述**: "需要X連擊才能造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `required_combo` (int): 需要的連擊數 (例如 10)

**配置範例**:
```json
{
  "effect_type": "REQUIRE_COMBO",
  "required_combo": 10
}
```

---

#### REQUIRE_COMBO_EXACT
**效果**: 需要連擊數完全等於指定值才能造成傷害
**中文描述**: "須保持連擊數 = X 連擊才可造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `required_combo` (int): 需要的連擊數 (例如 7)

**配置範例**:
```json
{
  "effect_type": "REQUIRE_COMBO_EXACT",
  "required_combo": 7
}
```

**說明**:
- 與 REQUIRE_COMBO 不同，此效果要求連擊數必須完全等於指定值
- REQUIRE_COMBO 是「大於等於」，REQUIRE_COMBO_EXACT 是「等於」
- 如果連擊數高於或低於指定值，都無法造成傷害

---

#### REQUIRE_COMBO_MAX
**效果**: 連擊數不可高於指定值，否則無法造成傷害
**中文描述**: "連擊數不可高於 X 連擊，否則無法造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `max_combo` (int): 最大允許連擊數 (例如 5)

**配置範例**:
```json
{
  "effect_type": "REQUIRE_COMBO_MAX",
  "max_combo": 5
}
```

**說明**:
- 此效果限制玩家不能使用過高的連擊數
- 連擊數必須小於等於 max_combo 才能造成傷害
- 適合作為「弱者之盾」類型的敵人技能

---

#### REQUIRE_ORB_TOTAL
**效果**: 需要消除指定數量的元素靈珠才能造成傷害
**中文描述**: "需要X粒Y屬性靈珠才能造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `required_element` (string): 需要的元素
- `required_count` (int): 需要的數量

**配置範例**:
```json
{
  "effect_type": "REQUIRE_ORB_TOTAL",
  "required_element": "FIRE",
  "required_count": 5
}
```

---

#### REQUIRE_ORB_CONTINUOUS
**效果**: 需要連續消除指定數量的元素靈珠
**中文描述**: "需要連續X粒Y屬性靈珠才能造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `required_element` (string): 需要的元素
- `required_count` (int): 連續數量

**配置範例**:
```json
{
  "effect_type": "REQUIRE_ORB_CONTINUOUS",
  "required_element": "WATER",
  "required_count": 3
}
```

---

#### REQUIRE_ELEMENTS
**效果**: 需要消除指定數量的不同元素才能造成傷害
**中文描述**: "需要X種元素才能造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `required_unique_elements` (int): 需要的元素種類數

**配置範例**:
```json
{
  "effect_type": "REQUIRE_ELEMENTS",
  "required_unique_elements": 3
}
```

---

#### REQUIRE_ENEMY_ATTACK
**效果**: 敵人必須先攻擊後才能造成傷害（條件可繼承回合）
**中文描述**: "敵人必須先攻擊後，否則無法造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**: 無

**配置範例**:
```json
{
  "effect_type": "REQUIRE_ENEMY_ATTACK"
}
```

**說明**:
- 此效果要求敵人必須在本回合內已經攻擊過，玩家才能對其造成傷害
- 條件會繼承到下一回合（與其他條件技能不同）
- 適合製作「反擊姿態」類型的敵人

---

#### REQUIRE_STORED_ORB_MIN
**效果**: 儲存的指定屬性靈珠必須達到要求數量（含以上）才能造成傷害
**中文描述**: "儲存X屬性靈珠必須達到Y個（含以上）才可造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `requirements` (array): 要求列表，每個元素包含：
  - `element` (string): 元素類型
  - `count` (int): 需要的數量

**配置範例**:
```json
{
  "effect_type": "REQUIRE_STORED_ORB_MIN",
  "requirements": [
	{"element": "FIRE", "count": 3},
	{"element": "WATER", "count": 2}
  ]
}
```

**說明**:
- 支持多元素要求，所有元素要求都必須同時滿足
- 檢查的是玩家儲存的靈珠數量，而非斬擊消除的數量
- 例如：火珠需要 >= 3 且 水珠需要 >= 2 才能造成傷害

---

#### REQUIRE_STORED_ORB_EXACT
**效果**: 儲存的指定屬性靈珠必須完全等於要求數量才能造成傷害
**中文描述**: "儲存X屬性靈珠必須達到Y個（完全一樣）才可造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `requirements` (array): 要求列表，每個元素包含：
  - `element` (string): 元素類型
  - `count` (int): 需要的數量

**配置範例**:
```json
{
  "effect_type": "REQUIRE_STORED_ORB_EXACT",
  "requirements": [
	{"element": "FIRE", "count": 3},
	{"element": "WATER", "count": 2}
  ]
}
```

**說明**:
- 與 REQUIRE_STORED_ORB_MIN 不同，此效果要求數量必須完全相等
- 支持多元素要求，所有元素要求都必須同時滿足
- 例如：火珠需要 = 3 且 水珠需要 = 2 才能造成傷害
- 如果數量多於或少於要求，都無法造成傷害

---

#### DAMAGE_ONCE_ONLY
**效果**: 敵人在本回合內只會被攻擊一次，第二次以後無法造成傷害
**中文描述**: "敵人只會被攻擊一次，第二次以後無法造成傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**: 無

**配置範例**:
```json
{
  "effect_type": "DAMAGE_ONCE_ONLY"
}
```

**說明**:
- 在同一回合內，對該敵人的第一次攻擊可以造成傷害
- 同一回合內的第二次及之後的攻擊無法造成傷害
- 回合結束後攻擊計數會重置
- 適合製作「單次傷害」或「護盾反應」類型的敵人

---

### 減傷類效果

#### DAMAGE_REDUCTION_PERCENT
**效果**: 減少受到的傷害（百分比）
**中文描述**: "減傷X%"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `reduction_percent` (float): 減傷百分比 (例如 50.0)

**配置範例**:
```json
{
  "effect_type": "DAMAGE_REDUCTION_PERCENT",
  "reduction_percent": 50.0
}
```

---

#### DAMAGE_REDUCTION_FLAT
**效果**: 減少受到的傷害（固定值）
**中文描述**: "減傷X點（固定）"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `reduction_amount` (int): 減傷數值 (例如 100)

**配置範例**:
```json
{
  "effect_type": "DAMAGE_REDUCTION_FLAT",
  "reduction_amount": 100
}
```

---

### 限制類效果

#### SEAL_ACTIVE_SKILL
**效果**: 封印玩家主動技能
**中文描述**: "封印主動技能X回合"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `duration` (int): 持續回合數

**配置範例**:
```json
{
  "effect_type": "SEAL_ACTIVE_SKILL",
  "duration": 3
}
```

---

#### DISABLE_ELEMENT_SLASH
**效果**: 禁用特定元素斬擊
**中文描述**: "禁用X屬性斬擊Y回合"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `target_element` (string): 目標元素
- `duration` (int): 持續回合數

**配置範例**:
```json
{
  "effect_type": "DISABLE_ELEMENT_SLASH",
  "target_element": "FIRE",
  "duration": 2
}
```

---

#### ZERO_RECOVERY
**效果**: 使回復力歸零
**中文描述**: "回復力歸零X回合"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `duration` (int): 持續回合數

**配置範例**:
```json
{
  "effect_type": "ZERO_RECOVERY",
  "duration": 2
}
```

---

#### REDUCE_SLASH_TIME
**效果**: 減少斬擊時間
**中文描述**: "減少斬擊時間X秒"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `reduce_seconds` (float): 減少秒數

**配置範例**:
```json
{
  "effect_type": "REDUCE_SLASH_TIME",
  "reduce_seconds": 2.0
}
```

---

### 特殊類效果

#### ENTER_HP_TO_ONE
**效果**: 進場時將玩家生命力扣至1
**中文描述**: "進場時生命力扣至1"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**: 無

**配置範例**:
```json
{
  "effect_type": "ENTER_HP_TO_ONE"
}
```

---

#### DEATH_DAMAGE
**效果**: 死亡時對玩家造成傷害
**中文描述**: "死亡時造成X點傷害"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**:
- `damage` (int): 傷害數值

**配置範例**:
```json
{
  "effect_type": "DEATH_DAMAGE",
  "damage": 1000
}
```

---

#### REVIVE_ONCE
**效果**: 可以復活一次
**中文描述**: "可復活一次"
**技能類別**: 敵方技能系列
**適用對象**: 敵方技能
**參數**: 無

**配置範例**:
```json
{
  "effect_type": "REVIVE_ONCE"
}
```

---

## 主動技能效果 (Active Skills)

主動技能效果ID以 `AS_` 開頭，配置於 `data/config/active_skills.json`

主動技能的 JSON 結構：
```json
{
  "skill_id": "AS_EXAMPLE",
  "skill_name": "技能名稱",
  "description": "技能描述",
  "skill_cost": 10,
  "effects": [
	{
	  "effect_type": "效果類型",
	  "參數名": "參數值"
	}
  ]
}
```

**基本參數說明**:
- `skill_id` (string): 技能唯一ID，以 AS_ 開頭
- `skill_name` (string): 技能名稱
- `description` (string): 技能描述
- `skill_cost` (int): 技能冷卻回合數 (CD)
- `duration` (int): 技能持續回合數（0表示瞬發技能）
- `target_type` (string): 目標類型（"SELF" 自己，"ENEMY" 敵人）
- `effects` (array): 技能效果列表

---

### 主動技能效果類型

#### COMBO_BOOST
**效果**: 提升連擊數計算基礎值
**中文描述**: "X回合內連擊數額外+Y"
**技能類別**: 主動技能系列
**適用對象**: 友軍技能
**參數**:
- `combo_bonus` (int): 連擊基礎值加成

**配置範例**:
```json
{
  "skill_id": "AS_MULTI_ATTACK_2TURN",
  "skill_name": "連擊強化",
  "description": "2回合內連擊數額外+5",
  "skill_cost": 12,
  "duration": 2,
  "target_type": "SELF",
  "effects": [
	{
	  "effect_type": "COMBO_BOOST",
	  "combo_bonus": 5
	}
  ]
}
```

**執行邏輯**:
- 如果 `combo_bonus = 10`，則連擊從10開始計算
- 第1次斬擊顯示為 11 連擊
- 第2次斬擊顯示為 12 連擊
- 第3次斬擊顯示為 13 連擊
- 實際連擊倍率計算使用顯示的連擊數

**說明**:
- 此效果會影響連擊倍率計算：倍率 = 1.0 + (顯示連擊數 × 0.25)
- 效果在主動技能使用後的指定回合數內有效
- 可與其他連擊相關效果疊加

---

#### DAMAGE_REDUCTION
**效果**: 減少玩家受到的傷害百分比
**中文描述**: "X回合內減傷Y%"
**技能類別**: 主動技能系列
**適用對象**: 友軍技能
**參數**:
- `reduction_percent` (float): 減傷百分比

**配置範例**:
```json
{
  "skill_id": "AS_DEFENSE_BOOST",
  "skill_name": "鐵壁防禦",
  "description": "3回合內減傷50%",
  "skill_cost": 15,
  "duration": 3,
  "target_type": "SELF",
  "effects": [
	{
	  "effect_type": "DAMAGE_REDUCTION",
	  "reduction_percent": 50.0
	}
  ]
}
```

**說明**:
- 減傷計算：實際受到傷害 = 原始傷害 × (1 - reduction_percent / 100)
- 例如：原始傷害 1000，減傷50%，實際受到 500 傷害
- 效果在指定回合數內持續有效
- 每回合結束時減少剩餘回合數

---

#### ELEMENT_DAMAGE_BOOST
**效果**: 提升指定元素的傷害倍率
**中文描述**: "X回合內Y屬性傷害提升Z%"
**技能類別**: 主動技能系列
**適用對象**: 友軍技能
**參數**:
- `element` (string): 目標元素
- `boost_percent` (float): 傷害提升百分比

**配置範例**:
```json
{
  "skill_id": "AS_FIRE_BOOST",
  "skill_name": "火焰強化",
  "description": "2回合內火屬性傷害提升100%",
  "skill_cost": 10,
  "duration": 2,
  "target_type": "SELF",
  "effects": [
	{
	  "effect_type": "ELEMENT_DAMAGE_BOOST",
	  "element": "FIRE",
	  "boost_percent": 100.0
	}
  ]
}
```

**說明**:
- 傷害倍率 = 1.0 + (boost_percent / 100)
- 例如：boost_percent = 100.0，則傷害倍率 = 2.0（雙倍傷害）
- 只影響指定元素的卡牌攻擊傷害
- 可與隊長技能的傷害倍率疊加

---

#### EXTEND_SLASH_TIME
**效果**: 立即延長斬擊時間（瞬發技能）
**中文描述**: "延長斬擊時間X秒"
**技能類別**: 都支持（隊長技能系列、主動技能系列）
**適用對象**: 友軍技能
**參數**:
- `extend_seconds` (float): 延長秒數
- `duration` (int): 必須設為 0（瞬發技能）

**配置範例**:
```json
{
  "skill_id": "AS_TIME_EXTEND",
  "skill_name": "時間延長",
  "description": "延長斬擊時間2秒",
  "skill_cost": 5,
  "duration": 0,
  "target_type": "SELF",
  "effects": [
	{
	  "effect_type": "EXTEND_SLASH_TIME",
	  "extend_seconds": 2.0
	}
  ]
}
```

**說明**:
- 這是瞬發技能，效果立即生效
- 必須在斬擊階段使用才有效果
- 延長的時間會立即加到當前斬擊倒計時上

---

## 參數類型說明

### 元素參數 (element / target_element / source_element)
**類型**: string
**可選值**: "FIRE", "WATER", "WOOD", "METAL", "EARTH", "HEART", "ALL"
**說明**: 指定元素類型，"ALL" 表示全部元素

### 倍率參數 (multiplier / base_multiplier / max_multiplier)
**類型**: float
**範圍**: 通常 0.1 ~ 10.0
**說明**: 屬性或傷害的倍率值，1.0 表示100%

### 百分比參數 (boost_percent / reduction_percent / effect_percent)
**類型**: float
**範圍**: 0.0 ~ 100.0
**說明**: 百分比數值，例如 50.0 表示 50%

### 數量參數 (count / damage / required_combo)
**類型**: int
**說明**: 整數數值，表示數量、傷害值、回合數等

### 時機參數 (drop_timing)
**類型**: string
**可選值**: "end_turn", "immediate"
**說明**: 效果觸發時機

---

## 元素類型對照表

| 英文代碼 | 中文名稱 | Constants 枚舉 |
|---------|---------|---------------|
| FIRE    | 火      | Constants.Element.FIRE |
| WATER   | 水      | Constants.Element.WATER |
| WOOD    | 木      | Constants.Element.WOOD |
| METAL   | 金      | Constants.Element.METAL |
| EARTH   | 土      | Constants.Element.EARTH |
| HEART   | 心      | Constants.Element.HEART |

---

## 技能配置完整範例

### 隊長技能範例

```json
{
  "leader_skills": [
	{
	  "skill_id": "LS_FIRE_COMBO",
	  "skill_name": "火焰大師",
	  "description": "火屬性傷害2倍，生命力1.5倍，回合結束造成500點火傷害",
	  "effects": [
		{
		  "effect_type": "DAMAGE_MULTIPLIER",
		  "target_element": "FIRE",
		  "multiplier": 2.0
		},
		{
		  "effect_type": "HP_MULTIPLIER",
		  "target_element": "FIRE",
		  "multiplier": 1.5
		},
		{
		  "effect_type": "END_TURN_DAMAGE",
		  "element": "FIRE",
		  "damage": 500
		}
	  ]
	}
  ]
}
```

### 敵人技能範例

```json
{
  "enemy_skills": [
	{
	  "skill_id": "ES_FIRE_SHIELD",
	  "skill_name": "火焰護盾",
	  "description": "需要5粒火珠才能造成傷害，減傷50%",
	  "effects": [
		{
		  "effect_type": "REQUIRE_ORB_TOTAL",
		  "required_element": "FIRE",
		  "required_count": 5
		},
		{
		  "effect_type": "DAMAGE_REDUCTION_PERCENT",
		  "reduction_percent": 50.0
		}
	  ]
	}
  ]
}
```

---

## 代碼引用位置

### SkillRegistry.gd
**路徑**: `scripts/autoload/SkillRegistry.gd`
**功能**: 技能註冊、創建、查詢
**關鍵方法**:
- `create_skill_instance(skill_id: String)`: 創建技能實例
- `get_skill_info(skill_id: String) -> Dictionary`: 獲取技能資訊
- `skill_exists(skill_id: String) -> bool`: 檢查技能是否存在

### SkillSystem.gd
**路徑**: `scripts/systems/SkillSystem.gd`
**功能**: JSON技能配置加載與解析
**關鍵方法**:
- `get_leader_skill(skill_id: String) -> Dictionary`: 獲取隊長技能數據
- `get_enemy_skill(skill_id: String) -> Dictionary`: 獲取敵人技能數據
- `get_active_skill(skill_id: String) -> Dictionary`: 獲取主動技能數據

### JSONSkillWrapper (內部類)
**路徑**: `SkillRegistry.gd` 內部類
**功能**: JSON技能的包裝執行器
**觸發時機**:
- `Constants.TriggerTiming.PERMANENT`: 永久效果
- `Constants.TriggerTiming.BEFORE_ATTACK`: 攻擊前觸發
- `Constants.TriggerTiming.TURN_START`: 回合開始
- `Constants.TriggerTiming.TURN_END`: 回合結束

### EnemySkillWrapper (內部類)
**路徑**: `SkillRegistry.gd` 內部類
**功能**: 敵人技能的包裝執行器
**特點**: 大多使用 PERMANENT 觸發時機

---

## 使用指南

### 如何創建新的隊長技能

1. 打開 `data/config/leader_skills.json`
2. 在 `leader_skills` 陣列中添加新技能
3. 設定 `skill_id`（必須以 LS_ 開頭）
4. 設定 `skill_name` 和 `description`
5. 在 `effects` 陣列中添加效果配置
6. 儲存文件，重新啟動遊戲即可生效

### 如何創建新的敵人技能

1. 打開 `data/config/enemy_skills.json`
2. 在 `enemy_skills` 陣列中添加新技能
3. 設定 `skill_id`（必須以 ES_ 開頭）
4. 配置效果參數
5. 儲存並測試

### 如何在卡片數據中使用技能

在 `data/cards/` 目錄下的卡片JSON文件中：

```json
{
  "card_id": "C001",
  "card_name": "火焰戰士",
  "leader_skill_ids": ["LS_FIRE_DAMAGE_2X"],
  "active_skill_id": "AS_FIRE_ATTACK",
  "active_skill_cd": 10
}
```

---

**文檔版本**: 1.0
**最後更新**: 2025-11-13
**維護者**: Claude Code
