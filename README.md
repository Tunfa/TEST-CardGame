# 斬滅戮

一款基於 Godot 4.x 引擎開發的斬珠 + 卡牌戰鬥遊戲。

## 🎮 遊戲簡介

《斬滅戮》是一款結合了斬擊珠子與卡牌戰鬥的策略遊戲。玩家需要在限時內連續斬擊元素珠子，累積連擊數和元素倍率，然後使用卡片對敵人發動攻擊。遊戲採用屬性相克系統，搭配豐富的技能組合，為玩家帶來充滿策略性的戰鬥體驗。

## ✨ 核心特色

- 🎯 **斬擊機制**：在限時內斬擊元素珠子，累積連擊和倍率
- 🃏 **卡片系統**：收集和組建自己的戰鬥隊伍
- ⚔️ **屬性相克**：金、木、水、火、土、心(負責補血) ; 五大元素循環相克
- 💫 **技能系統**：主動技能、被動技能、隊長技能的多樣組合
- 📈 **卡片練級**：斷界修途訓練系統，背景訓練機制
- ✨ **升星系統**：升仙台卡片進化系統，提升卡片星級
- 🗺️ **關卡模組化**：區域 → 章節 → 關卡的三層結構
- 🎯 **任務系統**：智能 UI 高亮引導，支援新手教學與任務流程
- 📖 **對話系統**：豐富的對話流程，與任務系統深度整合
- 🎲 **抽卡系統**：通過扭蛋獲取稀有卡片
- 🏪 **商城系統**：使用金幣和鑽石購買道具，支援限購機制
- 🛠️ **GM 編輯器**：完整的可視化內容編輯工具
- 📝 **對話任務編輯器**：可視化編輯對話與任務流程
- 🎮 **開發者控制台**：類似 CS1.6 的調試工具

## 📝 版本歷史

### 📌 最新版本

- **[V0.5 (2025-11-17) - 智能任務系統與對話系統](docs/changelogs/V0.5.md)**
  - 🎯 智能 UI 高亮系統：4 種查找策略（元數據、組、節點名稱、硬編碼）
  - 📖 完整的對話系統與任務引導流程
  - 🏪 商店購買限制修復：支援限購商品與購買次數追蹤
  - 📝 對話任務編輯器完全重構：修復編輯功能、添加中文說明
  - 🐛 修復 CardSelector 右鍵選單顯示問題（CanvasLayer 層級）
  - 📚 完整文檔：任務系統指南與訓練室示例

### 🗂️ 歷史版本

- **[V0.4 (2025-11-15) - 卡片升星系統「升仙台」](docs/changelogs/V0.4.md)**
  - ✨ 完整的卡片升星/進化系統
  - 🎴 卡片圖像化顯示，支援卡片預覽
  - 🎬 華麗的進化動畫效果（素材飛入、閃光、卡片展示）
  - 🔧 背包快速跳轉：右鍵選單新增「進化」選項
  - 🛠️ GM 編輯器全面升級：列表選擇器、搜尋功能
  - 🎯 進化系統完整驗證與錯誤提示

- **[V0.3 (2025-11-15) - 卡片練級系統「斷界修途」](docs/changelogs/V0.3.md)**
  - ⚔️ 完整的卡片練級系統與背景訓練機制
  - 📊 等級/經驗值系統（Lv.1~100）
  - 🎨 UI 全面優化：等級顯示與進度條
  - 🔧 數據結構重構：卡片實例系統升級
  - 🐛 修復重大 BUG：卡片等級持久化問題

- **[V0.2 (2025-11-15) - 關卡模組化系統與 GM 編輯器](docs/changelogs/V0.2.md)**
  - 🗺️ 完整的關卡模組化系統（區域→章節→關卡）
  - 🛠️ GM 編輯器新增區域/章節/關卡管理
  - 🎮 開發者控制台（~ 鍵喚起）
  - 💊 UI 改進：血條顯示與關卡選擇優化
  - 🐛 修復代碼警告和場景初始化問題

- **[V0.12 (2025-11-13) - 敵人技能系統完整修復](docs/changelogs/V0.12.md)**
  - 🐛 修復斬擊時間累積 BUG
  - 🐛 修復連擊數無法儲存問題
  - 🐛 修復攻擊目標顯示錯誤
  - 🔧 改進調試系統和代碼質量

- **[V0.1 (2025-11-13) - 卡片實例ID系統完整實現](docs/changelogs/V0.1.md)**
  - 🎯 實現卡片實例ID系統
  - 🔧 整合組隊、背包、戰鬥系統
  - 🐛 修復技能系統和代碼警告
  - 🎨 UI 美化改進

- **Beta V0.03.15 (早期版本)**
  - 基礎戰鬥系統
  - 元素珠子消除機制
  - 卡片系統基礎架構
  - 敵人AI系統

- **Beta V0.02.08 (早期版本)**
  - 項目初始化
  - UI框架搭建
  - 數據管理系統

## 🎯 核心系統

### 關卡系統

#### 世界地圖
- **五大區域環繞佈局**：
  - 🗻 北域 - 雪山之巔
  - 🔥 東域 - 烈焰荒漠
  - 🌊 南域 - 深海秘境
  - 🌳 西域 - 古森林
  - ⚡ 中域 - 雷霆高原
- **中央終極區域**：🌀 仙魔界海（需完成所有區域解鎖）
- **特殊區域**：☁️ 雲海秘境（活動/特殊關卡）

#### 章節系統
- **三層架構**：區域 → 章節 → 關卡
- **前置章節**：支持章節解鎖條件
- **獨立章節**：可設定獨立的章節分支
- **完成追蹤**：章節完成狀態顯示

### 戰鬥系統

- **斬機制**：在限時內按照各屬性靈珠的斬擊方向，斬擊珠子，提升卡片額外傷害
- **連擊系統**：每次斬擊增加連擊數，提升傷害倍率
- **元素倍率**：根據斬擊的元素珠數量計算攻擊倍率
- **波次戰鬥**：支持多波次敵人配置
- **屬性相克**：
  - 金 → 木 → 土 → 水 → 火 → 金（循環相克）
  - 心屬性：萬用元素，提供治療加成

### 卡片系統

- **實例ID管理**：每張卡片都有唯一標識
- **屬性系統**：金、木、水、火、土、心六大屬性
- **等級系統**：Lv.1~100，線性成長（Lv.1=10%屬性，Lv.100=100%屬性）
- **經驗值系統**：訓練獲得經驗值，累積升級
- **成長系統**：HP、攻擊力、回復力隨等級提升
- **技能槽位**：被動技能、主動技能、隊長技能

### 技能系統

- **主動技能**：消耗 SP 或 等待CD 發動，產生強大效果
- **被動技能**：永久提升角色能力
- **隊長技能**：隊長提供全隊加成
- **敵人技能**：
  - 永久技能（戰鬥開始時觸發）
  - 攻擊技能（敵人攻擊時觸發）
  - 條件技能（需要滿足特定條件）

### 訓練系統

- **斷界修途**：卡片練級專用訓練場
- **訓練室**：不同訓練室提供不同時長和經驗值
- **背景訓練**：訓練在背景進行，可離開場景做其他事
- **隊伍配置**：最多 5 張卡片一起訓練
- **經驗值分配**：完成訓練後每張卡片獲得經驗值
- **自動升級**：經驗值累積滿後自動升級
- **完成提醒**：主選單顯示訓練完成通知

### 任務系統

- **智能 UI 高亮**：動態查找並高亮任何 UI 元素
- **四種查找策略**：
  - 元數據查找（最靈活，推薦）
  - 組查找（最快速）
  - 節點名稱查找（最簡單）
  - 硬編碼路徑（向後兼容）
- **任務引導流程**：步驟化引導玩家完成任務
- **條件系統**：支援多種觸發條件（場景進入、對話完成、自訂事件等）
- **操作限制**：任務進行中限制玩家只能執行特定操作
- **視覺反饋**：紅色閃爍高亮提示當前目標

### 對話系統

- **豐富對話流程**：支援多段對話與分支選擇
- **與任務整合**：對話完成可觸發任務步驟
- **多種動作類型**：
  - 繼續對話 (next)
  - 關閉對話框 (close)
  - 顯示卡片選擇 (show_card_selection)
  - 高亮 UI 元素 (highlight_ui)
  - 前往場景 (go_to_scene)
  - 領取獎勵 (claim_reward)
- **對話配置**：JSON 配置文件，易於擴展
- **可視化編輯**：使用對話任務編輯器編輯

### 商店系統

- **金幣商店**：使用金幣購買道具
- **鑽石商店**：使用鑽石購買稀有物品
- **禮包系統**：組合商品優惠包
- **限購機制**：支援商品購買次數限制
- **購買追蹤**：記錄每個商品的購買次數
- **UI 反饋**：顯示購買進度 (X/Y)，達到上限時禁用按鈕

### 開發工具

#### GM 編輯器 (GM.py)
- **我方卡片管理**：編輯卡片屬性、技能
- **敵方卡片管理**：配置敵人數據
- **技能管理**：主動技能、隊長技能、敵人技能
- **關卡管理**：
  - 基本信息編輯
  - 波次配置
  - 敵人配置（每波）
  - 獎勵配置
  - 前置關卡設定
- **區域管理**：
  - 區域配置
  - 章節配置
  - 關卡分配

#### 對話任務編輯器 (DialogTaskEditor.py)
- **對話編輯**：管理遊戲對話流程 (dialogs.json)
  - 對話內容編輯
  - 對話選項管理（新增/編輯/刪除）
  - Action 類型選擇（帶中文說明）
  - 資訊面板顯示所有可用動作
- **任務編輯**：配置任務系統 (quests.json)
  - 任務基本信息
  - 任務步驟管理（新增/編輯/刪除）
  - 條件類型選擇（帶中文說明）
  - 動作配置
- **用戶體驗**：
  - 視覺化介面操作
  - 即時反饋與驗證
  - 智能值提取與保存

#### 開發者控制台
- **啟動方式**：按波浪號（~）鍵
- **基本命令**：help, clear, echo, quit
- **GM 命令**：
  - `/gm reset` - 重置存檔
  - `/gm unlock_all` - 解鎖所有關卡
  - `/gm add_gold <amount>` - 添加金幣
  - `/gm add_card <id>` - 添加卡片
- **特性**：
  - 彩色輸出
  - 命令歷史（上下箭頭）
  - 實時反饋

## 🛠️ 技術棧

- **引擎**: Godot 4.x
- **語言**: GDScript
- **編輯工具**: Python (Tkinter)
- **架構**: MVC 模式
- **數據持久化**: JSON 格式存檔
- **版本控制**: Git

## 📁 項目結構

```
thecardgame/
├── scripts/
│   ├── autoload/          # 全局管理器
│   │   ├── DataManager.gd
│   │   ├── PlayerDataManager.gd
│   │   ├── GameManager.gd
│   │   ├── TaskManager.gd
│   │   └── SkillRegistry.gd
│   ├── managers/          # 遊戲邏輯管理器
│   │   ├── BattleManager.gd
│   │   └── EffectManager.gd
│   ├── data/              # 數據結構
│   │   ├── CardData.gd
│   │   ├── EnemyData.gd
│   │   ├── TeamData.gd
│   │   └── StageData.gd
│   ├── ui/                # UI 界面
│   │   ├── BattleScene.gd
│   │   ├── MainMenu.gd
│   │   ├── ChapterSelect.gd
│   │   ├── StageSelect.gd
│   │   ├── DebugConsole.gd
│   │   └── ...
│   └── systems/           # 系統腳本
│       └── SkillSystem.gd
├── scenes/                # 場景文件
│   ├── main/             # 主選單
│   ├── battle/           # 戰鬥場景
│   ├── stage/            # 關卡選擇
│   ├── team/             # 組隊場景
│   ├── training/         # 訓練場景
│   └── ui/               # UI 組件
├── assets/                # 資源文件
│   ├── sprites/          # 圖片資源
│   ├── audio/            # 音頻資源
│   └── ...
├── data/                  # 遊戲數據（JSON）
│   ├── config/           # 配置文件
│   │   ├── cards.json
│   │   ├── enemies.json
│   │   ├── stages.json
│   │   ├── regions.json
│   │   ├── enemy_skills.json
│   │   ├── dialogs.json
│   │   ├── quests.json
│   │   └── ...
│   └── player_data.json  # 玩家存檔
├── tool/                  # 開發工具
│   ├── GM.py             # GM 編輯器
│   └── DialogTaskEditor.py  # 對話任務編輯器
└── docs/                  # 文檔
    ├── changelogs/       # 版本更新記錄
    ├── task_system_highlight_guide.md  # 任務系統指南
    └── task_highlight_example_training.md  # 訓練室示例
```

## 🎯 開發計劃

### ✅ 已完成

- [x] 卡片升級系統（V0.3）
- [x] 背景訓練機制（V0.3）
- [x] 卡片升星/進化系統（V0.4）
- [x] 智能任務系統（V0.5）
- [x] 對話系統（V0.5）
- [x] 商店購買限制（V0.5）

### 🔜 即將實現

- [ ] 完整新手教學任務流程
- [ ] 訓練室引導任務
- [ ] 章節完成進度追蹤
- [ ] 區域完成獎勵系統
- [ ] 關卡星級評價
- [ ] 多種訓練室
- [ ] 卡片突破系統

### 🚀 長期規劃

- [ ] 技能等級系統
- [ ] 訓練加速道具
- [ ] 每日任務系統
- [ ] 成就系統
- [ ] 對話分支選擇
- [ ] 角色立繪系統
- [ ] 商店 VIP 系統
- [ ] 多人對戰模式
- [ ] 公會系統
- [ ] 全球排行榜

## 🤝 貢獻

本項目目前處於活躍開發階段，歡迎：
- 提出建議和反饋
- 回報 Bug
- 提交 Pull Request
- 分享遊戲體驗

## 📜 授權

[待定]

---

**最後更新**: 2025-11-17
**當前版本**: V0.5
**開發引擎**: Godot 4.x
**開發狀態**: 🚧 活躍開發中
